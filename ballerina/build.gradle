import org.apache.tools.ant.taskdefs.condition.Os

/*
 * This file was generated by the Gradle 'init' task.
 */
//apply plugin: 'io.ballerina.plugin'

task build {
    doLast {
        project.exec {
            if (Os.isFamily(Os.FAMILY_WINDOWS)){
                commandLine 'cmd', '/c', 'bal pack && exit %%ERRORLEVEL%%'
            }
            else{
                commandLine 'sh', '-c', 'bal pack'
            }
        }
    }
}
task publishToLocalRepo{
    doLast {
        project.exec {
            if (Os.isFamily(Os.FAMILY_WINDOWS)){
                commandLine 'cmd', '/c', 'bal push --repository local && exit %%ERRORLEVEL%%'
            }
            else{
                commandLine 'sh', '-c', 'bal push --repository local'
            }
        }


    }
}

build.dependsOn ":native:build"
publishToLocalRepo.dependsOn build
publish.dependsOn publishToLocalRepo
